<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sets collection · OptEnrichedSetCover.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="OptEnrichedSetCover.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">OptEnrichedSetCover.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><a class="tocitem" href="method.html">Method description</a></li><li class="is-active"><a class="tocitem" href="mosaic.html">Sets collection</a><ul class="internal"><li><a class="tocitem" href="#Sets-mosaic"><span>Sets mosaic</span></a></li><li><a class="tocitem" href="#set_relevance"><span>Set relevance</span></a></li><li><a class="tocitem" href="#Masked-sets-mosaic"><span>Masked sets mosaic</span></a></li></ul></li><li><a class="tocitem" href="cover_problem.html">Cover problem</a></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="array_pool.html">Array pool</a></li><li><a class="tocitem" href="sparse_mask_matrix.html">Sparse mask matrix</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="mosaic.html">Sets collection</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="mosaic.html">Sets collection</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/master/docs/src/mosaic.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="mosaic"><a class="docs-heading-anchor" href="#mosaic">Sets collection</a><a id="mosaic-1"></a><a class="docs-heading-anchor-permalink" href="#mosaic" title="Permalink"></a></h1><h2 id="Sets-mosaic"><a class="docs-heading-anchor" href="#Sets-mosaic">Sets mosaic</a><a id="Sets-mosaic-1"></a><a class="docs-heading-anchor-permalink" href="#Sets-mosaic" title="Permalink"></a></h2><p>Gene Ontologies provide thousands of annotation terms. However, different genes often share the same annotations. This observation could be used to improve the processing of large collections. The genes could be grouped into disjoint <em>&quot;tiles&quot;</em> so that:</p><ul><li>all genes of the same tile share the same annotations</li><li>the tiles don&#39;t overlap and their <em>mosaic</em> covers all the genes</li><li>any annotation term could be represented as the (disjoint) union of the tiles</li></ul><p>This <em>&quot;mosaic&quot;</em> representation of the sets collection is implemented by the <code>SetMosaic</code> type. Internally it uses <a href="sparse_mask_matrix.html#OptEnrichedSetCover.SparseMaskMatrix"><code>SparseMaskMatrix</code></a> to maintain efficient element-to-set, element-to-tile etc mappings. Since there are (much) fewer tiles than individual elements, operations like sets union or intersection could be made much faster.</p><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.SetMosaic" href="#OptEnrichedSetCover.SetMosaic"><code>OptEnrichedSetCover.SetMosaic</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SetMosaic{T,S}</code></pre><p>Represents a collection of (potentially overlapping) sets as a &quot;mosaic&quot; of non-overlapping &quot;tiles&quot;.</p><p><strong>Type parameters</strong></p><ul><li><code>T</code>: type of set elements</li><li><code>S</code>: type of set keys</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/mosaic.jl#L93-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.nelements" href="#OptEnrichedSetCover.nelements"><code>OptEnrichedSetCover.nelements</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nelements(mosaic::SetMosaic) -&gt; Int</code></pre><p>The number of distinct elements (i.e. genes) in the sets collection.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/mosaic.jl#L211-L215">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.nsets" href="#OptEnrichedSetCover.nsets"><code>OptEnrichedSetCover.nsets</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nsets(mosaic::SetMosaic) -&gt; Int</code></pre><p>The number of sets in the collection.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/mosaic.jl#L225-L229">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.ntiles" href="#OptEnrichedSetCover.ntiles"><code>OptEnrichedSetCover.ntiles</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nsets(mosaic::SetMosaic) -&gt; Int</code></pre><p>The number of tiles (pairwise disjoint sets) in the mosaic representation of the set collection.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/mosaic.jl#L218-L222">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.set" href="#OptEnrichedSetCover.set"><code>OptEnrichedSetCover.set</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set(mosaic::SetMosaic, i::Integer) -&gt; AbstractVector{Int}</code></pre><p>Get the <code>i</code>-th set as the vector of indices of its elements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/mosaic.jl#L239-L243">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.setsize" href="#OptEnrichedSetCover.setsize"><code>OptEnrichedSetCover.setsize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set(mosaic::SetMosaic, i::Integer) -&gt; Int</code></pre><p>Get the size of the <code>i</code>-th set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/mosaic.jl#L246-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.tile" href="#OptEnrichedSetCover.tile"><code>OptEnrichedSetCover.tile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tile(mosaic::SetMosaic, i::Integer) -&gt; AbstractVector{Int}</code></pre><p>Get the <code>i</code>-th mosaic tile as the vector of indices of its elements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/mosaic.jl#L232-L236">source</a></section></article><h2 id="set_relevance"><a class="docs-heading-anchor" href="#set_relevance">Set relevance</a><a id="set_relevance-1"></a><a class="docs-heading-anchor-permalink" href="#set_relevance" title="Permalink"></a></h2><p>In the normal experiments, even the high-throughput ones, it&#39;s not possible to detect all annotated entities (genes or proteins). There&#39;s e.g. <em>detection bias</em> due to the experimental protocol or the <em>sensitivity limit</em> of the instrument. This must be taken into account when estimating, whether a particular gene set is enriched among e.g. upregulated genes – only the detected genes should be considered for the enrichment scores.</p><p>It may happen that the two distinct annotation terms share the same set of observed genes. In that case, their enrichment scores would be identical. If the enrichment is significant, both terms could be included in the report, but that would increase its <em>redundancy</em>. To solve this issue, <em>OptEnrichedSetCover</em> introduces the <em>set relevance score</em>. For example, if both <em>&quot;ribosome&quot;</em> and <em>&quot;small ribosomal subunits&quot;</em> terms are significant, but the genes of the <em>large ribosomal subunit</em> are not detected in the data, it&#39;s natural to prefer the &quot;small ribosomal subunit&quot; term over the whole ribosome. The <em>relevance score</em> formalizes that by estimating the enrichment of <em>detected</em> entities within each annotation term. See <a href="method.html#cover_quality_enrichment">cover quality</a> section for the exact definition of the <em>relevance score</em>.</p><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.set_relevance" href="#OptEnrichedSetCover.set_relevance"><code>OptEnrichedSetCover.set_relevance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_relevance(nset_observed::Integer, nset::Integer,
              nobserved::Integer, ntotal::Integer) -&gt; Float64</code></pre><p>Calculates the relevance weight of the set that contains <code>nset</code> elements, <code>nset_observed</code> of which were present (not necessarily enriched) in the data that identified <code>nobserved</code> elements out of all known (<code>ntotal</code>). It is used by <a href="mosaic.html#OptEnrichedSetCover.SetMosaic"><code>SetMosaic</code></a> to penalize the sets, which could not be observed in the data (e.g. biological processes or pathways that involve proteins not expressed by the cells used in the experiments).</p><p>While for <a href="mosaic.html#OptEnrichedSetCover.MaskedSetMosaic"><code>MaskedSetMosaic</code></a> it&#39;s recommended to use the IDs of data entities (e.g. protein group IDs for proteomic data) to correctly count the set sizes and estimate enrichment; <code>set_relevance()</code> should use the counts derived from the original IDs of the annotation database (e.g. UniProt accession codes). Otherwise it&#39;s not possible to correctly estimate the number of elements that belong to the given annotated set, but were not observed in the data.</p><p>The returned value is the probability that no more than <code>nset_observed</code> elements were observed at random.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/set_score.jl#L123-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.logpvalue" href="#OptEnrichedSetCover.logpvalue"><code>OptEnrichedSetCover.logpvalue</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">logpvalue(nisect::Integer, na::Integer, nb::Integer, ntotal::Integer,
          [tail::Symbol = :right])</code></pre><p>Log P-value for the two sets intersection.</p><p><code>A</code> has <code>na</code> elemnts, B has <code>nb</code> elements, they have <code>nisect</code> elements in common, and there are <code>ntotal</code> elements in the &quot;universe&quot;.</p><p><code>tail</code> controls the null hypothesis:</p><ul><li><code>:right</code> (default): by chance <code>A</code> and <code>B</code> would have ≥ elements in common</li><li><code>:left</code>: by chance <code>A</code> and <code>B</code> would have ≤ elements in common</li><li><code>:both</code>: by chance <code>A</code> and <code>B</code> would have either ≤ or ≥ elements in common, whichever is less probable</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/set_score.jl#L7-L21">source</a></section></article><h2 id="Masked-sets-mosaic"><a class="docs-heading-anchor" href="#Masked-sets-mosaic">Masked sets mosaic</a><a id="Masked-sets-mosaic-1"></a><a class="docs-heading-anchor-permalink" href="#Masked-sets-mosaic" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.AbstractWeightedSetMosaic" href="#OptEnrichedSetCover.AbstractWeightedSetMosaic"><code>OptEnrichedSetCover.AbstractWeightedSetMosaic</code></a> — <span class="docstring-category">Type</span></header><section><div><p><a href="mosaic.html#OptEnrichedSetCover.SetMosaic"><code>SetMosaic</code></a> with the weights assigned to its sets.</p><p><strong>Type parameters</strong></p><ul><li><code>T</code>: the type of elements</li><li><code>S</code>: the type of set ids</li><li><code>E</code>: the type of experiment ids</li><li><code>W</code>: type of the weight</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/weighted_mosaic.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.originalmosaic" href="#OptEnrichedSetCover.originalmosaic"><code>OptEnrichedSetCover.originalmosaic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">originalmosaic(mosaic::AbstractWeightedSetMosaic) -&gt; SetMosaic</code></pre><p>Get the original <a href="mosaic.html#OptEnrichedSetCover.SetMosaic"><code>SetMosaic</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/weighted_mosaic.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.MaskedSetMosaic" href="#OptEnrichedSetCover.MaskedSetMosaic"><code>OptEnrichedSetCover.MaskedSetMosaic</code></a> — <span class="docstring-category">Type</span></header><section><div><p><a href="mosaic.html#OptEnrichedSetCover.SetMosaic"><code>SetMosaic</code></a> with the elements masks (selections) on top. Sets that are not overlapping with the masks are excluded(skipped) from <code>MaskedSetMosaic</code>. Optionally, the filtering can include testing for the minimal overlap significance P-value.</p><p>The tiles of non-overlapped sets are removed, the tiles that have identical membership for all the masked sets are squashed into a single tile.</p><p><strong>Type parameters</strong></p><ul><li><code>T</code>: the type of elements</li><li><code>S</code>: the type of set ids</li><li><code>E</code>: the type of experiment ids</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/masked_mosaic.jl#L49-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.mask" href="#OptEnrichedSetCover.mask"><code>OptEnrichedSetCover.mask</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mask(mosaic::SetMosaic, elmasks::AbstractMatrix{Bool};
     [experiment_ids::Union{AbstractVector, AbstractSet, Nothing} = nothing],
     [min_nmasked=1], [max_setsize=nothing],
     [max_overlap_logpvalue=0.0]) -&gt; MaskedSetMosaic</code></pre><p>Construct <a href="mosaic.html#OptEnrichedSetCover.MaskedSetMosaic"><code>MaskedSetMosaic</code></a> from the <a href="mosaic.html#OptEnrichedSetCover.SetMosaic"><code>SetMosaic</code></a> and the collection of element masks.</p><p><strong>Arguments</strong></p><ul><li><code>min_nmasked</code>: the minimal number of masked elements in a set to include in the mosaic</li><li><code>max_setsize</code> (optional): ignore the annotation sets bigger than the specified size</li><li><code>max_overlap_logpvalue</code>: the threshold of Fisher&#39;s Exact Test log P-value of the overlap  between the set and the mask for the inclusion of the set into the mosaic.  <em>0</em> accepts all sets.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/masked_mosaic.jl#L103-L117">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.WeightedSetMosaic" href="#OptEnrichedSetCover.WeightedSetMosaic"><code>OptEnrichedSetCover.WeightedSetMosaic</code></a> — <span class="docstring-category">Type</span></header><section><div><p><a href="mosaic.html#OptEnrichedSetCover.SetMosaic"><code>SetMosaic</code></a> with the weights for the sets from multiple experiments on top.</p><p><strong>Type parameters</strong></p><ul><li><code>T</code>: the type of elements</li><li><code>S</code>: the type of set ids</li><li><code>E</code>: the type of experiment ids</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/weighted_mosaic.jl#L31-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OptEnrichedSetCover.assignweights" href="#OptEnrichedSetCover.assignweights"><code>OptEnrichedSetCover.assignweights</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">assignweights(mosaic::SetMosaic, elmasks::AbstractMatrix{Bool};
             [experiment_ids::Union{AbstractVector, AbstractSet, Nothing} = nothing],
             [max_setsize=nothing],
             [max_weight], [max_min_weight]) -&gt; WeightedSetMosaic</code></pre><p>Construct <a href="mosaic.html#OptEnrichedSetCover.WeightedSetMosaic"><code>WeightedSetMosaic</code></a> from the <a href="mosaic.html#OptEnrichedSetCover.SetMosaic"><code>SetMosaic</code></a> and the external <code>weights</code>.</p><p><strong>Arguments</strong></p><ul><li><code>max_setsize</code> (optional): ignore the annotation sets bigger than the specified size</li><li><code>max_weight</code> (optional): the maximal weight of the set to include in the mosaic</li><li><code>max_min_weight</code> (optional): the maximual weight of the set <em>in all experiments</em> to include the set into mosaic</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/OptEnrichedSetCover.jl/blob/3c7d20894d5c3e1eee5b5ec019e234b0c3ce5ce7/src/weighted_mosaic.jl#L73-L86">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="method.html">« Method description</a><a class="docs-footer-nextpage" href="cover_problem.html">Cover problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 2 December 2023 20:42">Saturday 2 December 2023</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
